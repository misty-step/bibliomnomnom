# TODO – Bibliomnomnom Aesthetic Overhaul

Context: Everything below drives the “luminous reading lab” identity—bone backgrounds, electric azure CTAs, nectar warmth, dreamy gradients, halftone overlays, and grayscale photography. All implementation must enforce information hiding via semantic tokens and deep component modules so future features inherit the look by default.

- [x] Establish token pipeline (`design-tokens.json`, generator script, CSS var output, Tailwind `theme.extend` integration, TS typings) encoding the final palette (Bone, Ink, Nightfall, Electric Azure, Orchid, Nectar), typography stacks (Canela/Romie display + Söhne/N. Montreal UI + JetBrains Mono accent), spacing ladder, radii, elevations, textures, and motion tokens. Success criteria: running `pnpm tokens:build` regenerates vars without git diff; Tailwind + global CSS pull from the generated file only; tokens cover gradients (`sky-dawn`, `azure-orchid`) and glass blur values.
- [x] Sweep repo for hard-coded color/spacing values and replace them with the new semantic token utilities (codemod or scripted `rg` replace). Include `app/globals.css`, components, and Convex/Clerk UI overrides. Success criteria: `rg '#[0-9a-fA-F]{3,6}' app components` returns zero matches other than token definitions/tests; spacing constants also route through tokens.
- [ ] Add ESLint rule/custom plugin enforcing `design-tokens` usage (block raw colors/spacing/shadows in JSX/TS/TSX/CSS) and document rationale in `eslint.config.js`. Success criteria: lint fails when adding literal hex/rgb values outside token files; message references “luminous reading lab token contract”.
- [ ] Document the token contract (color roles, typography scale, spacing ladder, elevation levels, texture intents, motion curve aliases) in `DESIGN.md` including mapping to emotional goals (calm bone canvas, electric focus cues). Success criteria: engineers can map any token name to intent via this doc without reading code; doc sections include “When to use Electric Azure vs Nectar”.
- [ ] Implement `Surface` primitive (`components/ui/Surface.tsx`) representing our deep module for backgrounds (props: `tone`, `elevation`, `texture`, `padding`, `as`, `interactive`). Include Storybook stories showing hero glass, nav rail, and note card states plus unit tests for class composition. Success criteria: all downstream components consume `Surface` instead of bespoke divs for elevated/glass backgrounds.
- [ ] Rebuild `Button` component using tokens (variants: `primary-electric`, `secondary-bone`, `subtle-glass`, `ghost-ink`, `icon`) and motion states that respect `prefers-reduced-motion`. Include typographic tweaks (uppercase mono label for tertiary actions) and success criteria: visual regression tests cover each variant + focus/disabled states with ≥4.5:1 contrast.
- [ ] Create `TextureOverlay` utility (CSS mask helpers + Tailwind plugin) with predefined halftone/grain assets referenced via semantic tokens (`texture-cloud`, `texture-matrix`, `texture-grain`). Success criteria: hero + card components import overlays via class names, not inline SVG blobs; overlay respects light/dark tokens automatically.
- [ ] Implement `SplitBillboard` layout component powering marketing hero + auth screens with slots (`eyebrow`, `title`, `body`, `cta`, `media`, `statPanel`). Component should support gradient backgrounds, texture overlays, and drop-in grayscale photography per brief. Success criteria: `app/page.tsx` hero and Clerk pages use `SplitBillboard`, layout meets 320px width requirements, and stat panel uses `MetricCard`.
- [ ] Build `MetricCard` compound component + `useMetricCardData` hook that formats stats (value, delta, context copy, pill tags) and injects textures per intent (data viz vs narrative). Success criteria: cards render correctly with mock data Storybook story + unit tests covering number formatting, delta polarity, and skeleton state.
- [ ] Introduce `BookTile` component (cover frame with inner shadow, progress ring, metadata stack with mono labels, skeleton state, context menu slot) and replace existing grid usage in `/library`. Success criteria: list + collection views share the same tile implementation with no duplicated markup; hover shows halftone overlay consistent with brand.
- [ ] Refactor marketing home (`app/page.tsx`) to new hero, feature rows, CTA/footer while loading commissioned assets via `next/image` + skeleton fallback state. Include grayscale trust section referencing privacy ethos. Success criteria: lighthouse CLS stays <0.1, hero stats use live mock data hook, and all sections rely on tokens/primitives only.
- [ ] Wire asset loader module (`lib/assets.ts`) mapping semantic image IDs (`hero-sky-dawn`, `auth-hand-constellation`, `trust-portrait`) to static files + `next/image` metadata; implement graceful degradation when asset missing (fallback gradient + blurred notes). Success criteria: hero/auth components request assets by key only; error path logged once.
- [ ] Themate Clerk auth screens using tokens (background split, Electric Azure panel, IDP buttons, typography) by injecting custom theme + `SplitBillboard` layout. Ensure focus/validation states meet WCAG contrast and mimic marketing hero texture. Success criteria: `/sign-in` + `/sign-up` share the same layout component, pass axe checks, and degrade to mono layout when illustrations fail to load.
- [ ] Build `LibraryNav` rail (Surface variant, icon buttons with mono labels, progress indicator) and embed it into the dashboard layout wrapper. Include keyboard navigation (arrow traversal) + responsive collapse ≤768px with accessible toggle. Success criteria: nav keeps active route highlighting in sync with Next router, and collapse stores preference.
- [ ] Implement `useInsights` hook that aggregates Convex data into normalized view models (reading pace, theme cloud tags, recommendation sets) with suspense + feature flag gating. Hook should hide Convex response shape and expose semantic fields (title, stat, supporting copy, trend). Success criteria: UI cards consume hook output only; fallback skeleton when data absent or flag disabled.
- [ ] Create insight card components (Reading Pace sparkline, Theme Cloud halftone blob, Recommendations stack, Activity Timeline) using `MetricCard` + texture overlays. Include placeholder data for when backend incomplete and ensure cards hide themselves when data missing. Success criteria: cards render responsively, maintain ≤60fps scrolling, and all typography aligns with tokens.
- [ ] Update book detail page layout (hero with cover + shimmering gradient, metadata stack, note section surfaces, CTA row) to new primitives + motion system. Success criteria: detail hero reuses `Surface`, copy lines wrap cleanly at 320px, and note list uses TextureOverlay for emphasis.
- [ ] Add motion layer utilities (page fade, hover lift, stat number roll) implemented via tokens (`motion-snappy`, `motion-drift`) with `prefers-reduced-motion` guards. Integrate into hero transitions, CTA hover, nav indicator, and book tile focus ring. Success criteria: disabling motion removes transforms without layout shift or opacity flash.
- [ ] Expand automated tests: Playwright visual snapshots for hero/auth/dashboard (covering gradient + texture combos), plus unit tests for hooks (`useInsights`, `useMetricCardData`) and interaction tests for `LibraryNav` keyboard flow. Success criteria: `pnpm test` covers new components and prevents regressions during rollout; CI artifacts include baseline screenshots for review.
