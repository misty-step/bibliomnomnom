This directory serves as the test suite for navigation components within the `bibliomnomnom` application, specifically focusing on the `LibraryNav` component. The architecture utilizes **Vitest** as the test runner and **React Testing Library** for DOM-based assertions, emphasizing behavioral testing through user interactions and accessibility attributes.

### Key File Roles

- **`LibraryNav.test.tsx`**: Validates the core functionality of the library's navigation interface. It ensures that the active route is correctly identified using `aria-current`, verifies that the navigation sidebar can toggle between expanded and collapsed states, and confirms that layout variations (e.g., "bar" vs. sidebar) render the appropriate UI elements.

### Dependencies and Integration

The tests rely on several critical dependencies and environment mocks:

- **Next.js Navigation**: The `usePathname` hook from `next/navigation` is manually mocked to simulate specific routing contexts, which is essential for testing the "active" state of navigation links.
- **Lucide React**: Used for icon rendering within the navigation items.
- **Vitest & React Testing Library**: Provide the execution environment and utility functions for rendering components and firing events like `click`.

### Technical Gotchas

- **Storage Mocking**: Because the `LibraryNav` component persists its collapsed state, the test suite implements a custom `localStorage` mock for the JSDOM environment. This mock tracks state changes in-memory to verify that user preferences are correctly saved to the browser's storage.
- **State Persistence**: The suite explicitly tests the side effect of clicking the collapse toggle, ensuring the stringified boolean value is correctly updated in `localStorage` under the key `library-nav-collapsed`.
- **Conditional Rendering**: The tests distinguish between sidebar and bar layouts, noting that the "Collapse" functionality is conditionally omitted when the component is rendered in the bar configuration.
