The `/docs/deployment` directory serves as the central operational repository for the bibliomnomnom deployment lifecycle, governing the transition of the application from local development to production. The architecture centers on a synchronized multi-platform integration between Vercel (frontend hosting), Convex (backend and database), and Stripe (payment processing).

The primary component of this directory is the `pre-production-checklist.md`, which defines the protocols for environment variable management, cross-platform parity, and build validation. It establishes a strict hierarchy for environment files, utilizing `.env.local` for development and a gitignored `.env.production` for local production testing. A core architectural requirement documented here is the mandatory synchronization of the `CONVEX_WEBHOOK_TOKEN` across both Vercel and Convex to ensure secure and functional webhook delivery.

Key dependencies for the deployment workflow include the Bun runtime for script execution and testing, alongside the Vercel, Convex, and Stripe CLIs for cloud environment management. The directory also references `jq` for processing deep health-check responses.

Significant technical gotchas highlighted in the documentation include:

- **Environment Variable Corruption:** Vercel environment pulls can introduce trailing newlines (`\n`), leading to "Invalid character in header" errors or signature verification failures. The documentation mandates using `printf` instead of `echo` to set variables to avoid these characters.
- **CLI State Confusion:** The Convex CLI may return development data even when `CONVEX_DEPLOYMENT` is set to production; the `--prod` flag is required for reliable production data operations.
- **Webhook Parity:** Discrepancies between Stripe webhook secrets or the absence of the webhook token on either the backend or frontend will result in silent failures or 500 errors during the checkout flow.
- **Sourcing Rules:** `.env.production` must be explicitly sourced manually as it is not loaded by default, preventing accidental production credential usage during development.
