This directory contains the core health monitoring and service probing infrastructure for the system. It provides a standardized framework for assessing the availability and latency of critical external dependencies, specifically Convex, Clerk, and Stripe. The architecture is designed around a functional probing model that normalizes network responses and asynchronous error states into a consistent health schema.

### Architecture and Key File Roles

- **`types.ts`**: Defines the system's health domain model and state machine. It establishes the `ServiceCheckResult` and `HealthPayload` interfaces. It includes the `overallStatus` utility, which implements the promotion logic for aggregate health: any individual service marked as "down" transitions the global system state to "degraded."
- **`probes.ts`**: Contains the execution logic for service-specific health checks. It utilizes a centralized `probeUrl` helper that manages request orchestration, including timeout enforcement via `AbortController` and latency calculation. It implements service-specific protocols, such as `HEAD` requests for Convex, JWKS endpoint validation for Clerk, and authenticated balance retrieval for Stripe.
- **`__tests__/` (Subdirectory)**: A validation suite utilizing Vitest to ensure probe reliability. It simulates diverse network conditions—including successful responses, HTTP errors, and request timeouts—by mocking the global `fetch` implementation and manipulating the event loop with fake timers.

### Dependencies and Technical Constraints

- **Web Fetch API & AbortController**: The probing mechanism is built on the standard Web Fetch API. It relies on `AbortSignal` for timeout management; the `sanitizeError` function specifically intercepts `AbortError` (via `DOMException`) to categorize timeouts separately from standard network errors or `TypeErrors`.
- **Stripe Authentication**: The Stripe probe requires a valid secret key and performs pre-request regex validation (`/^sk_(test|live)_[a-zA-Z0-9]+$/`) to prevent header injection or unnecessary network traffic for malformed keys.
- **Service Targeting**: The Clerk probe is hardcoded to target the `.well-known/jwks.json` endpoint, ensuring that the health check validates the service's ability to provide the keys necessary for JWT verification.
- **Configuration Handling**: Probes are designed to be "fail-soft" regarding configuration; if a required URL or API key is missing, the system returns an "unknown" status rather than a "down" status, preventing false positives in environments where certain services are optional or unconfigured.
